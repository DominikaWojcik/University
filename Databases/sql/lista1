#1
WITH AA AS (SELECT *
    FROM grupa JOIN przedmiot_semestr USING(kod_przed_sem)
        JOIN przedmiot USING(kod_przed)
        JOIN uzytkownik USING(kod_uz)
    WHERE semestr_id=38 AND rodzaj_zajec='c')

SELECT DISTINCT nazwisko
FROM AA
WHERE nazwa='Matematyka dyskretna (M)'
ORDER BY nazwisko;


#2
WITH wyklad AS (SELECT kod_przed_sem
    FROM przedmiot JOIN przedmiot_semestr USING(kod_przed)
        JOIN grupa USING(kod_przed_sem)
    WHERE semestr_id=38 AND rodzaj_zajec='w' AND nazwa='Matematyka dyskretna (M)')

SELECT imie||' '||nazwisko
FROM grupa JOIN wyklad ON grupa.kod_przed_sem=wyklad.kod_przed_sem
    JOIN wybor USING(kod_grupy)
    JOIN uzytkownik ON wybor.kod_uz=uzytkownik.kod_uz
ORDER BY data DESC
LIMIT 1;

#3
WITH wyklad AS (SELECT kod_przed_sem
    FROM przedmiot JOIN przedmiot_semestr USING(kod_przed)
        JOIN grupa USING(kod_przed_sem)
    WHERE semestr_id=38 AND rodzaj_zajec='w' AND nazwa='Matematyka dyskretna (M)'),

zapisy AS (SELECT data
    FROM grupa JOIN wyklad ON grupa.kod_przed_sem=wyklad.kod_przed_sem
    JOIN wybor on grupa.kod_grupy=wybor.kod_grupy)

SELECT MAX(date_trunc('day', z1.data - z2.data + interval '1 day'))
FROM zapisy z1, zapisy z2;

#4
SELECT COUNT(DISTINCT nazwa)
FROM grupa NATURAL JOIN przedmiot_semestr NATURAL JOIN przedmiot
WHERE rodzaj_zajec='r';

#5
WITH przedZimOb AS (SELECT kod_przed_sem
    FROM przedmiot_semestr NATURAL JOIN przedmiot
        JOIN semestr USING(semestr_id)
    WHERE semestr.nazwa LIKE '% zimowy %' AND przedmiot.rodzaj='o')

SELECT COUNT(DISTINCT kod_uz)
FROM grupa JOIN przedZimOb USING (kod_przed_sem)
    NATURAL JOIN uzytkownik
WHERE grupa.rodzaj_zajec='c';

#6
SELECT DISTINCT przedmiot.nazwa
FROM grupa NATURAL JOIN uzytkownik
    NATURAL JOIN przedmiot_semestr
    NATURAL JOIN przedmiot
WHERE uzytkownik.nazwisko='Urban'
ORDER BY nazwa;

#7
SELECT COUNT(nazwisko)
FROM uzytkownik
WHERE nazwisko LIKE 'Kabacki%';

#8
WITH grupyAISD AS (SELECT kod_grupy, semestr_id
    FROM grupa NATURAL JOIN przedmiot_semestr
        NATURAL JOIN przedmiot
    WHERE nazwa='Algorytmy i struktury danych (M)'),

zapisyNaAISD AS (SELECT kod_grupy, kod_uz, semestr_id
    FROM wybor JOIN grupyAISD USING(kod_grupy))

SELECT COUNT(DISTINCT kod_uz)
FROM zapisyNaAISD z1 JOIN zapisyNaAISD z2 USING(kod_uz)
WHERE z1.semestr_id != z2.semestr_id;

#9
SELECT semestr_id
FROM przedmiot_semestr NATURAL JOIN przedmiot
WHERE rodzaj='o'
GROUP BY semestr_id
ORDER BY COUNT(kod_przed_sem) ASC
LIMIT 1;

#10
SELECT COUNT(DISTINCT kod_grupy)
FROM grupa NATURAL JOIN przedmiot_semestr
    NATURAL JOIN przedmiot
    JOIN semestr USING(semestr_id)
WHERE semestr.nazwa LIKE '% zimowy 2010/2011'
    AND przedmiot.nazwa LIKE 'Logika dla informatyk√≥w%';

#11
SELECT semestr_id
FROM przedmiot_semestr NATURAL JOIN przedmiot
WHERE przedmiot.rodzaj='o'
GROUP BY semestr_id
ORDER BY COUNT(kod_przed_sem) DESC
LIMIT 1;

#12
